### Main target

+ 上一节实现的富文本编辑器存在的问题
+ 事件驱动的设计思想
+ 数据驱动的设计思想



## 01. 上一节实现的富文本编辑器存在的问题

### 问题

1. 用 execCommand 实现编辑受浏览器实现的限制
2. 用HTML文档作为存储具有不确定性

#### execCommand

**fontSize**

+ 只支持 1- 7
+ 不支持自定义的字号大小



#### execCommand兼容性

**paste**

+ Chrome 浏览器上不支持
+ Document.queryCommandSupported()



#### HTML存储

+ bold

  + Chrome浏览器渲染为  <b>

  ```html
  <b>我被加粗了</b>
  ```

  + IE浏览器渲染为 <strong>

  ```html
  <strong>我被加粗了</strong>
  ```

+ 先加粗后倾斜

  ```html
  <b><i> 我被加粗了，也被倾斜了 </i></b>
  ```

+ 先加粗后倾斜

  ```html
  <i><b> 我被加粗了，也被倾斜了 </b></i>
  ```

+ 语义上相等，数据上不等

#### 改进

HTML存储 ==> 自定义存储格式

execCommand == > 自己实现 修改文档的操作

**事件驱动 ==> 数据驱动**



## 02. 事件驱动的设计思想

### 事件

+ 事件
  + 外部环境发出的可以被软件识别和处理的动作
  + 通常是异步的
+ DOM事件
  + 用于通知代码相关的事情已经发生，是JavaScript 与HTML 交互的基础
  + UI事件、焦点、鼠标事件、文本事件、键盘事件、剪贴板事件、拖拽事件等
  + 事件捕获、事件冒泡、事件代理



#### 事件驱动的设计方式

按照"用户交互通过事件修改页面"的思想设计前端网页，在原生JS开发，用jQuery进行开发的时候常用这种设计方式

设计DOM ==> 设计DOM上需要监听的事件 ==> 设计事件的处理函数



#### 事件驱动的运行方式

DOM 绑定 处理函数

事件 触发 处理函数

处理函数 修改 DOM



#### 上一节编辑器的设计思想

工具栏添加按钮 ==> 监听按钮事件 ==> 事件处理函数中执行对应的命令 ==> 命令直接修改 DOM

(**事件驱动**)



## 03.  数据驱动的设计思想

#### MVC

+ Model - View - Control
+ Backbone



#### MVVM

+ Model - View - ViewModel
+ Angular，Vue
+ 双向数据绑定（data-binding）



#### 单向数据流

+ React + Redux



#### 数据

数据层

+ MVC中的model
+ data-binding 里 的 data
+ Flux/Redux 里 的store

#### 数据驱动的设计方式

按照“用户交互通过修改数据影响页面”的思想设计前端网页，在使用React + Redux ，Vue , Angular，Backbone等框架开发时常有这种设计方式

设计数据 ==> 设计视图 ==> 设计事件监听 ==> 设计修改数据的处理函数



#### 数据驱动的运行方式

事件 触发 处理函数

视图 绑定 处理函数

处理函数 修改 数据

数据 渲染 视图



#### 数据驱动设计思想的好处

+ 数据和视图分开，利于解耦
+ 数据层抽象设计，利于复用和拓展
+ 视图层结构简单，利于组件化



### 最后小结

+ 问题

  + HTML存储
  + execCommand

+ 事件驱动

  用户交互通过事件修改页面

+ 数据驱动

  用户交互通过修改数据影响页面





